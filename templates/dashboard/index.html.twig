{% extends 'base.html.twig' %}

{% block title %}Dashboard | Brew&Books{% endblock %}

{% block body %}

<main>
    <section class="page__content">

        <div class="page__content-details" style="align-items: center;">
            <div class="details-head">
                <h1>Welcome, </h1>
            </div>
        </div>

        <div class="page__content-details">
            <div class="page__content-overview">
                {% include 'common/total_count.html.twig' %}
            </div>

            {% if lowStockProducts is not empty %}
            <div class="low-stock-alert">
                <i class="fa-solid fa-exclamation-triangle"></i>
                <div class="low-stock-alert-content">
                    <h3>Low Stock Alert</h3>
                    <p>{{ lowStockProducts|length }} item(s) are running low and need restocking soon</p>
                </div>
            </div>
            {% endif %}

            <div class="details-head" style="align-items: baseline;">
                <h3 style="margin: 0;"> Recent Updates </h3>
            </div>
            <div class="card-info-details">

                <div class="table">
                    {% if recentLogs is not empty %}
                    <table class="table datatable" id="recent-logs-table">
                        <thead>
                            <tr>
                                <th>When</th>
                                <th>Action</th>
                                <th>Table</th>
                                <th>ID</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in recentLogs %}
                            <tr>
                                <td>{{ log.occurredAt|date('Y-m-d H:i', 'Asia/Manila') }}</td>
                                <td>{{ log.action|capitalize }}</td>
                                <td>{{ log.entityName }}</td>
                                <td>{{ log.entityId }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p>No recent updates.</p>
                    {% endif %}
                </div>
            </div>
    </section>
</main>

{% endblock %}